drop table if exists recent_day_count_road_12_1; create table recent_day_count_road_12_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_12 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_2; create table recent_day_count_road_12_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_12 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_3; create table recent_day_count_road_12_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_12 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_4; create table recent_day_count_road_12_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_12 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_5; create table recent_day_count_road_12_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_12 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_6; create table recent_day_count_road_12_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_12 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_7; create table recent_day_count_road_12_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_12 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_10; create table recent_day_count_road_12_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_12 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_15; create table recent_day_count_road_12_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_12 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_30; create table recent_day_count_road_12_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_12 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_12_60; create table recent_day_count_road_12_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_12 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_12_predict; create table recent_day_count_road_12_predict as select gd_train_data_12.card_id, recent_day_count_road_12_1.day_count_1 as day_count_1, recent_day_count_road_12_2.day_count_2 as day_count_2, recent_day_count_road_12_3.day_count_3 as day_count_3, recent_day_count_road_12_4.day_count_4 as day_count_4, recent_day_count_road_12_5.day_count_5 as day_count_5, recent_day_count_road_12_6.day_count_6 as day_count_6, recent_day_count_road_12_7.day_count_7 as day_count_7, recent_day_count_road_12_10.day_count_10 as day_count_10, recent_day_count_road_12_15.day_count_15 as day_count_15, recent_day_count_road_12_30.day_count_30 as day_count_30, recent_day_count_road_12_60.day_count_60 as day_count_60 from gd_train_data_12 left outer join recent_day_count_road_12_1 on gd_train_data_12.card_id=recent_day_count_road_12_1.card_id  left outer join recent_day_count_road_12_2 on gd_train_data_12.card_id=recent_day_count_road_12_2.card_id  left outer join recent_day_count_road_12_3 on gd_train_data_12.card_id=recent_day_count_road_12_3.card_id  left outer join recent_day_count_road_12_4 on gd_train_data_12.card_id=recent_day_count_road_12_4.card_id  left outer join recent_day_count_road_12_5 on gd_train_data_12.card_id=recent_day_count_road_12_5.card_id  left outer join recent_day_count_road_12_6 on gd_train_data_12.card_id=recent_day_count_road_12_6.card_id  left outer join recent_day_count_road_12_7 on gd_train_data_12.card_id=recent_day_count_road_12_7.card_id  left outer join recent_day_count_road_12_10 on gd_train_data_12.card_id=recent_day_count_road_12_10.card_id  left outer join recent_day_count_road_12_15 on gd_train_data_12.card_id=recent_day_count_road_12_15.card_id  left outer join recent_day_count_road_12_30 on gd_train_data_12.card_id=recent_day_count_road_12_30.card_id  left outer join recent_day_count_road_12_60 on gd_train_data_12.card_id=recent_day_count_road_12_60.card_id ;

drop table if exists recent_day_count_road_15_1; create table recent_day_count_road_15_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_15 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_2; create table recent_day_count_road_15_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_15 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_3; create table recent_day_count_road_15_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_15 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_4; create table recent_day_count_road_15_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_15 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_5; create table recent_day_count_road_15_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_15 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_6; create table recent_day_count_road_15_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_15 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_7; create table recent_day_count_road_15_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_15 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_10; create table recent_day_count_road_15_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_15 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_15; create table recent_day_count_road_15_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_15 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_30; create table recent_day_count_road_15_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_15 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_15_60; create table recent_day_count_road_15_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_15 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_15_predict; create table recent_day_count_road_15_predict as select gd_train_data_15.card_id, recent_day_count_road_15_1.day_count_1 as day_count_1, recent_day_count_road_15_2.day_count_2 as day_count_2, recent_day_count_road_15_3.day_count_3 as day_count_3, recent_day_count_road_15_4.day_count_4 as day_count_4, recent_day_count_road_15_5.day_count_5 as day_count_5, recent_day_count_road_15_6.day_count_6 as day_count_6, recent_day_count_road_15_7.day_count_7 as day_count_7, recent_day_count_road_15_10.day_count_10 as day_count_10, recent_day_count_road_15_15.day_count_15 as day_count_15, recent_day_count_road_15_30.day_count_30 as day_count_30, recent_day_count_road_15_60.day_count_60 as day_count_60 from gd_train_data_15 left outer join recent_day_count_road_15_1 on gd_train_data_15.card_id=recent_day_count_road_15_1.card_id  left outer join recent_day_count_road_15_2 on gd_train_data_15.card_id=recent_day_count_road_15_2.card_id  left outer join recent_day_count_road_15_3 on gd_train_data_15.card_id=recent_day_count_road_15_3.card_id  left outer join recent_day_count_road_15_4 on gd_train_data_15.card_id=recent_day_count_road_15_4.card_id  left outer join recent_day_count_road_15_5 on gd_train_data_15.card_id=recent_day_count_road_15_5.card_id  left outer join recent_day_count_road_15_6 on gd_train_data_15.card_id=recent_day_count_road_15_6.card_id  left outer join recent_day_count_road_15_7 on gd_train_data_15.card_id=recent_day_count_road_15_7.card_id  left outer join recent_day_count_road_15_10 on gd_train_data_15.card_id=recent_day_count_road_15_10.card_id  left outer join recent_day_count_road_15_15 on gd_train_data_15.card_id=recent_day_count_road_15_15.card_id  left outer join recent_day_count_road_15_30 on gd_train_data_15.card_id=recent_day_count_road_15_30.card_id  left outer join recent_day_count_road_15_60 on gd_train_data_15.card_id=recent_day_count_road_15_60.card_id ;

drop table if exists recent_day_count_road_2_1; create table recent_day_count_road_2_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_2 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_2; create table recent_day_count_road_2_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_2 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_3; create table recent_day_count_road_2_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_2 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_4; create table recent_day_count_road_2_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_2 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_5; create table recent_day_count_road_2_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_2 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_6; create table recent_day_count_road_2_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_2 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_7; create table recent_day_count_road_2_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_2 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_10; create table recent_day_count_road_2_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_2 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_15; create table recent_day_count_road_2_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_2 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_30; create table recent_day_count_road_2_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_2 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_2_60; create table recent_day_count_road_2_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_2 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_2_predict; create table recent_day_count_road_2_predict as select gd_train_data_2.card_id, recent_day_count_road_2_1.day_count_1 as day_count_1, recent_day_count_road_2_2.day_count_2 as day_count_2, recent_day_count_road_2_3.day_count_3 as day_count_3, recent_day_count_road_2_4.day_count_4 as day_count_4, recent_day_count_road_2_5.day_count_5 as day_count_5, recent_day_count_road_2_6.day_count_6 as day_count_6, recent_day_count_road_2_7.day_count_7 as day_count_7, recent_day_count_road_2_10.day_count_10 as day_count_10, recent_day_count_road_2_15.day_count_15 as day_count_15, recent_day_count_road_2_30.day_count_30 as day_count_30, recent_day_count_road_2_60.day_count_60 as day_count_60 from gd_train_data_2 left outer join recent_day_count_road_2_1 on gd_train_data_2.card_id=recent_day_count_road_2_1.card_id  left outer join recent_day_count_road_2_2 on gd_train_data_2.card_id=recent_day_count_road_2_2.card_id  left outer join recent_day_count_road_2_3 on gd_train_data_2.card_id=recent_day_count_road_2_3.card_id  left outer join recent_day_count_road_2_4 on gd_train_data_2.card_id=recent_day_count_road_2_4.card_id  left outer join recent_day_count_road_2_5 on gd_train_data_2.card_id=recent_day_count_road_2_5.card_id  left outer join recent_day_count_road_2_6 on gd_train_data_2.card_id=recent_day_count_road_2_6.card_id  left outer join recent_day_count_road_2_7 on gd_train_data_2.card_id=recent_day_count_road_2_7.card_id  left outer join recent_day_count_road_2_10 on gd_train_data_2.card_id=recent_day_count_road_2_10.card_id  left outer join recent_day_count_road_2_15 on gd_train_data_2.card_id=recent_day_count_road_2_15.card_id  left outer join recent_day_count_road_2_30 on gd_train_data_2.card_id=recent_day_count_road_2_30.card_id  left outer join recent_day_count_road_2_60 on gd_train_data_2.card_id=recent_day_count_road_2_60.card_id ;

drop table if exists recent_day_count_road_8_1; create table recent_day_count_road_8_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_8 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_2; create table recent_day_count_road_8_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_8 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_3; create table recent_day_count_road_8_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_8 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_4; create table recent_day_count_road_8_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_8 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_5; create table recent_day_count_road_8_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_8 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_6; create table recent_day_count_road_8_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_8 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_7; create table recent_day_count_road_8_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_8 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_10; create table recent_day_count_road_8_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_8 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_15; create table recent_day_count_road_8_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_8 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_30; create table recent_day_count_road_8_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_8 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_8_60; create table recent_day_count_road_8_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_8 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_8_predict; create table recent_day_count_road_8_predict as select gd_train_data_8.card_id, recent_day_count_road_8_1.day_count_1 as day_count_1, recent_day_count_road_8_2.day_count_2 as day_count_2, recent_day_count_road_8_3.day_count_3 as day_count_3, recent_day_count_road_8_4.day_count_4 as day_count_4, recent_day_count_road_8_5.day_count_5 as day_count_5, recent_day_count_road_8_6.day_count_6 as day_count_6, recent_day_count_road_8_7.day_count_7 as day_count_7, recent_day_count_road_8_10.day_count_10 as day_count_10, recent_day_count_road_8_15.day_count_15 as day_count_15, recent_day_count_road_8_30.day_count_30 as day_count_30, recent_day_count_road_8_60.day_count_60 as day_count_60 from gd_train_data_8 left outer join recent_day_count_road_8_1 on gd_train_data_8.card_id=recent_day_count_road_8_1.card_id  left outer join recent_day_count_road_8_2 on gd_train_data_8.card_id=recent_day_count_road_8_2.card_id  left outer join recent_day_count_road_8_3 on gd_train_data_8.card_id=recent_day_count_road_8_3.card_id  left outer join recent_day_count_road_8_4 on gd_train_data_8.card_id=recent_day_count_road_8_4.card_id  left outer join recent_day_count_road_8_5 on gd_train_data_8.card_id=recent_day_count_road_8_5.card_id  left outer join recent_day_count_road_8_6 on gd_train_data_8.card_id=recent_day_count_road_8_6.card_id  left outer join recent_day_count_road_8_7 on gd_train_data_8.card_id=recent_day_count_road_8_7.card_id  left outer join recent_day_count_road_8_10 on gd_train_data_8.card_id=recent_day_count_road_8_10.card_id  left outer join recent_day_count_road_8_15 on gd_train_data_8.card_id=recent_day_count_road_8_15.card_id  left outer join recent_day_count_road_8_30 on gd_train_data_8.card_id=recent_day_count_road_8_30.card_id  left outer join recent_day_count_road_8_60 on gd_train_data_8.card_id=recent_day_count_road_8_60.card_id ;

drop table if exists recent_day_count_road_10_1; create table recent_day_count_road_10_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_10 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_2; create table recent_day_count_road_10_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_10 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_3; create table recent_day_count_road_10_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_10 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_4; create table recent_day_count_road_10_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_10 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_5; create table recent_day_count_road_10_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_10 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_6; create table recent_day_count_road_10_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_10 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_7; create table recent_day_count_road_10_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_10 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_10; create table recent_day_count_road_10_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_10 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_15; create table recent_day_count_road_10_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_10 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_30; create table recent_day_count_road_10_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_10 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_10_60; create table recent_day_count_road_10_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_10 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_10_predict; create table recent_day_count_road_10_predict as select gd_train_data_10.card_id, recent_day_count_road_10_1.day_count_1 as day_count_1, recent_day_count_road_10_2.day_count_2 as day_count_2, recent_day_count_road_10_3.day_count_3 as day_count_3, recent_day_count_road_10_4.day_count_4 as day_count_4, recent_day_count_road_10_5.day_count_5 as day_count_5, recent_day_count_road_10_6.day_count_6 as day_count_6, recent_day_count_road_10_7.day_count_7 as day_count_7, recent_day_count_road_10_10.day_count_10 as day_count_10, recent_day_count_road_10_15.day_count_15 as day_count_15, recent_day_count_road_10_30.day_count_30 as day_count_30, recent_day_count_road_10_60.day_count_60 as day_count_60 from gd_train_data_10 left outer join recent_day_count_road_10_1 on gd_train_data_10.card_id=recent_day_count_road_10_1.card_id  left outer join recent_day_count_road_10_2 on gd_train_data_10.card_id=recent_day_count_road_10_2.card_id  left outer join recent_day_count_road_10_3 on gd_train_data_10.card_id=recent_day_count_road_10_3.card_id  left outer join recent_day_count_road_10_4 on gd_train_data_10.card_id=recent_day_count_road_10_4.card_id  left outer join recent_day_count_road_10_5 on gd_train_data_10.card_id=recent_day_count_road_10_5.card_id  left outer join recent_day_count_road_10_6 on gd_train_data_10.card_id=recent_day_count_road_10_6.card_id  left outer join recent_day_count_road_10_7 on gd_train_data_10.card_id=recent_day_count_road_10_7.card_id  left outer join recent_day_count_road_10_10 on gd_train_data_10.card_id=recent_day_count_road_10_10.card_id  left outer join recent_day_count_road_10_15 on gd_train_data_10.card_id=recent_day_count_road_10_15.card_id  left outer join recent_day_count_road_10_30 on gd_train_data_10.card_id=recent_day_count_road_10_30.card_id  left outer join recent_day_count_road_10_60 on gd_train_data_10.card_id=recent_day_count_road_10_60.card_id ;

drop table if exists recent_day_count_road_4_1; create table recent_day_count_road_4_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_4 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_2; create table recent_day_count_road_4_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_4 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_3; create table recent_day_count_road_4_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_4 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_4; create table recent_day_count_road_4_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_4 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_5; create table recent_day_count_road_4_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_4 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_6; create table recent_day_count_road_4_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_4 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_7; create table recent_day_count_road_4_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_4 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_10; create table recent_day_count_road_4_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_4 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_15; create table recent_day_count_road_4_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_4 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_30; create table recent_day_count_road_4_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_4 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_4_60; create table recent_day_count_road_4_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_4 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_4_predict; create table recent_day_count_road_4_predict as select gd_train_data_4.card_id, recent_day_count_road_4_1.day_count_1 as day_count_1, recent_day_count_road_4_2.day_count_2 as day_count_2, recent_day_count_road_4_3.day_count_3 as day_count_3, recent_day_count_road_4_4.day_count_4 as day_count_4, recent_day_count_road_4_5.day_count_5 as day_count_5, recent_day_count_road_4_6.day_count_6 as day_count_6, recent_day_count_road_4_7.day_count_7 as day_count_7, recent_day_count_road_4_10.day_count_10 as day_count_10, recent_day_count_road_4_15.day_count_15 as day_count_15, recent_day_count_road_4_30.day_count_30 as day_count_30, recent_day_count_road_4_60.day_count_60 as day_count_60 from gd_train_data_4 left outer join recent_day_count_road_4_1 on gd_train_data_4.card_id=recent_day_count_road_4_1.card_id  left outer join recent_day_count_road_4_2 on gd_train_data_4.card_id=recent_day_count_road_4_2.card_id  left outer join recent_day_count_road_4_3 on gd_train_data_4.card_id=recent_day_count_road_4_3.card_id  left outer join recent_day_count_road_4_4 on gd_train_data_4.card_id=recent_day_count_road_4_4.card_id  left outer join recent_day_count_road_4_5 on gd_train_data_4.card_id=recent_day_count_road_4_5.card_id  left outer join recent_day_count_road_4_6 on gd_train_data_4.card_id=recent_day_count_road_4_6.card_id  left outer join recent_day_count_road_4_7 on gd_train_data_4.card_id=recent_day_count_road_4_7.card_id  left outer join recent_day_count_road_4_10 on gd_train_data_4.card_id=recent_day_count_road_4_10.card_id  left outer join recent_day_count_road_4_15 on gd_train_data_4.card_id=recent_day_count_road_4_15.card_id  left outer join recent_day_count_road_4_30 on gd_train_data_4.card_id=recent_day_count_road_4_30.card_id  left outer join recent_day_count_road_4_60 on gd_train_data_4.card_id=recent_day_count_road_4_60.card_id ;

drop table if exists recent_day_count_road_7_1; create table recent_day_count_road_7_1 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_1 from gd_train_data_7 where deal_time>='2014123005' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_2; create table recent_day_count_road_7_2 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_2 from gd_train_data_7 where deal_time>='2014122905' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_3; create table recent_day_count_road_7_3 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_3 from gd_train_data_7 where deal_time>='2014122805' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_4; create table recent_day_count_road_7_4 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_4 from gd_train_data_7 where deal_time>='2014122705' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_5; create table recent_day_count_road_7_5 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_5 from gd_train_data_7 where deal_time>='2014122605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_6; create table recent_day_count_road_7_6 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_6 from gd_train_data_7 where deal_time>='2014122505' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_7; create table recent_day_count_road_7_7 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_7 from gd_train_data_7 where deal_time>='2014122405' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_10; create table recent_day_count_road_7_10 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_10 from gd_train_data_7 where deal_time>='2014122105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_15; create table recent_day_count_road_7_15 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_15 from gd_train_data_7 where deal_time>='2014121605' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_30; create table recent_day_count_road_7_30 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_30 from gd_train_data_7 where deal_time>='2014120105' and deal_time<'2014123105' group by Card_id;drop table if exists recent_day_count_road_7_60; create table recent_day_count_road_7_60 as select Card_id, count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD'))) as day_count_60 from gd_train_data_7 where deal_time>='2014110105' and deal_time<'2014123105' group by Card_id;

drop table if exists recent_day_count_road_7_predict; create table recent_day_count_road_7_predict as select gd_train_data_7.card_id, recent_day_count_road_7_1.day_count_1 as day_count_1, recent_day_count_road_7_2.day_count_2 as day_count_2, recent_day_count_road_7_3.day_count_3 as day_count_3, recent_day_count_road_7_4.day_count_4 as day_count_4, recent_day_count_road_7_5.day_count_5 as day_count_5, recent_day_count_road_7_6.day_count_6 as day_count_6, recent_day_count_road_7_7.day_count_7 as day_count_7, recent_day_count_road_7_10.day_count_10 as day_count_10, recent_day_count_road_7_15.day_count_15 as day_count_15, recent_day_count_road_7_30.day_count_30 as day_count_30, recent_day_count_road_7_60.day_count_60 as day_count_60 from gd_train_data_7 left outer join recent_day_count_road_7_1 on gd_train_data_7.card_id=recent_day_count_road_7_1.card_id  left outer join recent_day_count_road_7_2 on gd_train_data_7.card_id=recent_day_count_road_7_2.card_id  left outer join recent_day_count_road_7_3 on gd_train_data_7.card_id=recent_day_count_road_7_3.card_id  left outer join recent_day_count_road_7_4 on gd_train_data_7.card_id=recent_day_count_road_7_4.card_id  left outer join recent_day_count_road_7_5 on gd_train_data_7.card_id=recent_day_count_road_7_5.card_id  left outer join recent_day_count_road_7_6 on gd_train_data_7.card_id=recent_day_count_road_7_6.card_id  left outer join recent_day_count_road_7_7 on gd_train_data_7.card_id=recent_day_count_road_7_7.card_id  left outer join recent_day_count_road_7_10 on gd_train_data_7.card_id=recent_day_count_road_7_10.card_id  left outer join recent_day_count_road_7_15 on gd_train_data_7.card_id=recent_day_count_road_7_15.card_id  left outer join recent_day_count_road_7_30 on gd_train_data_7.card_id=recent_day_count_road_7_30.card_id  left outer join recent_day_count_road_7_60 on gd_train_data_7.card_id=recent_day_count_road_7_60.card_id ;

