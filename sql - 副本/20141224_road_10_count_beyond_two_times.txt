drop table if exists count_beyond_two_times_road_10; create table count_beyond_two_count_road_10 as select a.card_id,a.beyond_two_count_7,b.beyond_two_count_30 from (select Card_id, (count(*)-count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD')))) as beyond_two_count_7 from gd_train_data_10 where deal_time>='2014121705' and deal_time<'2014122405' group by Card_id) a join (select Card_id, (count(*)-count(distinct(datetrunc(to_date(deal_time,'yyyymmddhh'),'DD')))) as beyond_two_count_30 from gd_train_data_10 where deal_time>='2014112405' and deal_time<'2014122405' group by Card_id) b on a.card_id=b.card_id 